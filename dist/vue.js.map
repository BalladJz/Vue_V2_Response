{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/index.js"],"sourcesContent":["/** 定义observer 类 */\n\n/**\n * 实现数据的响应式（双向绑定）\n * @param {*} value 传入需要实现响应式的数据\n * @param {*} cb 数据更新调用的回调函数\n * @returns\n */\nfunction observe(value, cb = undefined) {\n  // 声明一个ob 用来标记数据是否是响应式的\n  let ob\n  // 判断 如果数据有“__ob__”这个属性，则不添加\n  if (typeof value.__ob__ !== 'undefined') {\n    ob = value.__ob__\n  } else {\n    // 判断 如果数据没有“__ob__”这个属性，则添加上\n    ob = new observer(value, cb)\n  }\n  return ob\n}\n\n/**\n * 实现响应式的方法\n * @param {*} obj 实现相应式的数据\n * @param {*} key 实现相应式的数据的属性\n * @param {*} val 相当于闭包的一个参数\n * @param {*} cb 数据更新调用的回调函数\n */\nfunction defineReactive(obj, key, val, cb) {\n  Object.defineProperty(obj, key, {\n    get: () => {\n      console.log('get => 获取数据', val)\n      return val\n    },\n    set: (value) => {\n      console.log('set => 更新数据', value)\n      val = value\n      cb ? cb(value) : null\n    },\n  })\n}\n\n/**\n *  通过类\n *  1、添加响应式标志\n *  2、实现响应式\n */\nclass observer {\n  constructor(value, cb) {\n    //  给数据添加'__ob__'属性，且可以精确设置它能够被枚举，重写等\n    Object.defineProperty(value, '__ob__', {\n      value: this,\n      enumerable: false,\n    })\n    // 调用类的方法成员，遍历数据 实现响应式\n    this.walk(value, cb)\n  }\n  walk(value, cb) {\n    Object.keys(value).forEach((key) => {\n      defineReactive(value, key, value[key], cb)\n    })\n  }\n}\n\nexport { observe, observer }\n","import { observe } from './observer/index'\n\nfunction Vue(options) {\n  // const vm = this\n  this.$options = options\n\n  // 代理options.data  options.data可能是函数，也可能是一个对象\n  this.proxy_data = typeof options.data === 'function' ? options.data() : options.data\n  // 实现数据的响应式（双向绑定） 传入需要实现响应式的数据\n  observe(this.proxy_data)\n  // 代理的方法\n  // ! .call(this, \n  _proxy.call(this, this.proxy_data)\n}\n\n/**\n * 代理Vue中的数据，通过实例可直接访问 vm.XXX 或 this.XXX\n * @param {*} data 要代理的数据\n */\nfunction _proxy(data) {\n  // 遍历需要代理的数据\n  Object.keys(data).forEach((key) => {\n    // 通过 Object.defineProperty() 方法给每一个数据实现可以通过 vm.XXX 或 this.XXX 可以获取和设置\n    Object.defineProperty(this, key, {\n      get() {\n        console.log('_proxy => get 获取')\n        return this.proxy_data[key]\n      },\n      set(value) {\n        console.log('_proxy => set 设置')\n        this.proxy_data[key] = value\n      },\n    })\n  })\n}\n\nexport default Vue\n"],"names":["observe","value","cb","undefined","ob","__ob__","observer","defineReactive","obj","key","val","Object","defineProperty","get","console","log","set","constructor","enumerable","walk","keys","forEach","Vue","options","$options","proxy_data","data","_proxy","call"],"mappings":"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"}