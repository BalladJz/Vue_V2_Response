{"version":3,"file":"vue.js","sources":["../src/observer/dep.js","../src/observer/index.js","../src/index.js"],"sourcesContent":["class Dep {\n    constructor() {\n        this.subs = []\n    }\n    // 成员方法\n    addSubs() {\n        console.log('Dep类 addSubs => 添加依懒')\n    }\n    depend() {\n        console.log('Dep类 depend =>  收集依懒')\n    }\n    notify(newValue) {\n        console.log('Dep类 depend =>  通知依懒')\n    }\n}\n\nexport {Dep}","import { Dep } from './dep.js'\n/** 定义observer 类 */\n\n\n/**\n * 实现响应式的方法\n * @param {*} obj 实现相应式的数据\n * @param {*} key 实现相应式的数据的属性\n * @param {*} val 相当于闭包的一个参数\n * @param {*} cb 数据更新调用的回调函数\n */\nfunction defineReactive(obj, key, val, cb) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {\n    get: () => {\n      console.log('defineReactive get => 获取数据', val)\n      //  收集依赖\n      dep.depend()\n\n      return val\n    },\n    set: (value) => {\n      console.log('defineReactive set => 更新数据', value)\n      val = value\n      // 通知依懒 (触发依懒的更新)\n      dep.notify(value) \n\n      cb ? cb(value) : null\n    },\n  })\n}\n\n/**\n *  通过类\n *  1、添加响应式标志\n *  2、实现响应式\n */\nclass Observer {\n  constructor(value, cb) {\n    //  给数据添加'__ob__'属性，且可以精确设置它能够被枚举，重写等\n    Object.defineProperty(value, '__ob__', {\n      // this表示 observe类 \n      value: this,\n      enumerable: false,\n    })\n    // 因为 Observer 与 Dep 是关联的 所以在实例化Observer是要 new一个Dep\n    const dep = new Dep()\n\n\n    // 调用类的方法成员，遍历数据 实现响应式\n    this.walk(value, cb)\n  }\n  walk(value, cb) {\n    Object.keys(value).forEach((key) => {\n      defineReactive(value, key, value[key], cb)\n    })\n  }\n}\n\n\n/**\n * 实现数据的响应式（双向绑定）\n * @param {*} value 传入需要实现响应式的数据\n * @param {*} cb 数据更新调用的回调函数\n * @returns\n */\nfunction observe(value, cb = undefined) {\n  // 声明一个ob 用来标记数据是否是响应式的\n  let ob\n  // 判断 如果数据有“__ob__”这个属性，则不添加\n  if (typeof value.__ob__ !== 'undefined') {\n    ob = value.__ob__\n  } else {\n    // 判断 如果数据没有“__ob__”这个属性，则添加上\n    ob = new Observer(value, cb)\n  }\n  return ob\n}\n\nexport { observe, Observer }\n","import { observe } from './observer/index'\nimport { Watcher } from './observer/watcher.js'\n\n/**\n * 代理Vue中的数据，通过实例可直接访问 vm.XXX 或 this.XXX\n * @param {*} data 要代理的数据\n */\nfunction _proxy(data) {\n  // 遍历需要代理的数据\n  Object.keys(data).forEach((key) => {\n    // 通过 Object.defineProperty() 方法给每一个数据实现可以通过 vm.XXX 或 this.XXX 可以获取和设置\n    Object.defineProperty(this, key, {\n      get() {\n        console.log('_proxy get => 获取')\n        return this.proxy_data[key]\n      },\n      set(value) {\n        console.log('_proxy set => 设置')\n        this.proxy_data[key] = value\n      },\n    })\n  })\n}\n\nfunction Vue(options) {\n  // const vm = this\n  this.$options = options\n\n  // 代理options.data  options.data可能是函数，也可能是一个对象\n  this.proxy_data = typeof options.data === 'function' ? options.data() : options.data\n  // 实现数据的响应式（双向绑定） 传入需要实现响应式的数据\n  observe(this.proxy_data)\n  // 代理的方法\n  // ! .call(this, \n  _proxy.call(this, this.proxy_data)\n\n  // this表示Vue的 ？？？\n  new Watcher(this, 'a', () => {\n\n  })\n}\n\nexport default Vue\n"],"names":["Dep","constructor","subs","addSubs","console","log","depend","notify","newValue","defineReactive","obj","key","val","cb","dep","Object","defineProperty","get","set","value","Observer","enumerable","walk","keys","forEach","observe","undefined","ob","__ob__","_proxy","data","proxy_data","Vue","options","$options","call"],"mappings":"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"}